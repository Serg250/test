"use strict";function serial(){let e=document.querySelectorAll(".star");for(let t of e)if(t.hasAttribute("checked"))return t.value;return!1}function init(e,t=!1,n){outHtml(n),setClass()}function ElClick(){let e=document.querySelectorAll(".star"),t=document.getElementById("rating");[].forEach.call(e,function(e){e.onclick=function(n){if(t.classList.contains("on")){let t=Number.parseInt(document.getElementById("count").textContent);send(e.value,t)}return!1}})}function outHtml(e){let t="",n=5;for(;n>0;)t=t+'<input class="star" type="radio" id="star-'+n+'" name="rating" value="'+n+'"><label for="star-'+n+'" title="Оценка «'+n+'»"></label>',n--;return e.innerHTML=t,!0}function get_cookie(){let e=document.cookie.match("(^|;) ?rating=([^;]*)(;|$)");return!!e&&unescape(e[2])}function set_cookie(){let e=new Date(Date.now()+864e6);return e=e.toUTCString(),document.cookie="rating=yes; expires="+e,!0}function setClass(){get_cookie()?(document.getElementById("rating").classList.add("off"),document.getElementById("rating").classList.remove("on")):(document.getElementById("rating").classList.add("on"),document.getElementById("rating").classList.remove("off"))}function setRatingInit(){let e=Number.parseInt(document.getElementById("rat").textContent),t=5,n=document.getElementsByClassName("star");for(let o of n)t==e&&(o.checked=!0),t--;return!0}function setRating(e){if(!get_cookie()){e<1&&(e=1),e>5&&(e=5);let t=5,n=document.getElementsByClassName("star");for(let o of n)t==e&&(o.checked=!0),t--}return setClass(),e}function delCheck(e){if(!get_cookie()){let e=document.querySelectorAll(".star");[].forEach.call(e,function(e){e.checked=!1})}return e}function send(e,t){const n=new XMLHttpRequest,o="rat="+e+"&count="+t;n.responseType="json",n.open("POST","data_rating.php",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.addEventListener("readystatechange",()=>{if(4===n.readyState&&200===n.status){let e=n.response;document.getElementById("count").innerHTML=e.count,document.getElementById("rat").innerHTML=e.all,setRating(Number.parseInt(e.all));document.getElementById("rating"),Number.parseInt(document.getElementById("rat").textContent);set_cookie()}}),n.send(o)}function jsClick(){let e=document.getElementById("sel"),t=Number.parseInt(e.value)/64*100;document.getElementById("fill").style.width=t+"%",document.getElementById("num").innerHTML=t+"%",document.getElementById("num").style.right="10px"}window.onload=function(){let e=document.getElementById("rating"),t=Number.parseInt(document.getElementById("rat").textContent),n=t;init(t,!1,e,t),setRatingInit();let o=document.getElementById("rating");o.onmouseover=function(e){n=delCheck(n)},o.onmouseout=function(e){setRating(Number.parseInt(document.getElementById("rat").textContent))};serial();ElClick()};